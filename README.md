# üêï PetCare - Sistema de Cuidado de Mascotas

Sistema completo de gesti√≥n de cuidadores de mascotas con autenticaci√≥n JWT, roles de usuario y dashboard interactivo.

## üìã √çndice
1. [Caracter√≠sticas](#caracter√≠sticas)
2. [Arquitectura](#arquitectura)
3. [Instalaci√≥n](#instalaci√≥n)
4. [Uso](#uso)
5. [API Endpoints](#api-endpoints)
6. [Base de Datos](#base-de-datos)
7. [Mantenimiento](#mantenimiento)
8. [Troubleshooting](#troubleshooting)

---

## ‚ú® Caracter√≠sticas

### üîê Autenticaci√≥n y Autorizaci√≥n
- **JWT Tokens** - Autenticaci√≥n segura con tokens de 24 horas
- **Roles de Usuario** - Cliente y Cuidador con permisos espec√≠ficos
- **Validaci√≥n de Credenciales** - Verificaci√≥n de email y contrase√±a
- **Verificaci√≥n de Roles** - Control de acceso basado en roles

### üë• Gesti√≥n de Usuarios
- **Registro de Usuarios** - Formulario completo con validaciones
- **Login con Rol** - Selecci√≥n de tipo de usuario al iniciar sesi√≥n
- **Perfiles de Cuidador** - Informaci√≥n detallada y verificaci√≥n
- **Dashboard Personalizado** - Interfaz espec√≠fica por rol

### üè† Dashboard de Cuidador
- **Perfil Completo** - Foto, calificaciones, verificaci√≥n
- **Informaci√≥n de Contacto** - Documento, tel√©fono, email
- **Servicios Ofrecidos** - Lista de servicios disponibles
- **Tarifas y Horarios** - Precios y disponibilidad
- **Biograf√≠a y Experiencia** - Informaci√≥n personal
- **Estad√≠sticas** - M√©tricas de rendimiento

### üé® Interfaz de Usuario
- **Dise√±o Moderno** - Bootstrap 5 con gradientes y animaciones
- **Responsive** - Adaptable a m√≥viles y desktop
- **Validaci√≥n en Tiempo Real** - Feedback inmediato al usuario
- **Mensajes de Estado** - Notificaciones de √©xito y error
- **Navegaci√≥n Intuitiva** - Flujo claro entre vistas

---

## üèóÔ∏è Arquitectura

### Stack Tecnol√≥gico
```
Frontend: React 18 + TypeScript + Vite + Bootstrap 5
Backend:  .NET 8 + Entity Framework + ASP.NET Identity
Database: SQL Server
Auth:     JWT Tokens
Deploy:   Docker + Docker Compose
```

### Estructura del Proyecto
```
PetCareServicios/
‚îú‚îÄ‚îÄ PetCareBackend/          # API .NET
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/         # Controladores de API
‚îÇ   ‚îú‚îÄ‚îÄ Services/           # L√≥gica de negocio
‚îÇ   ‚îú‚îÄ‚îÄ Models/             # Modelos de datos
‚îÇ   ‚îú‚îÄ‚îÄ Data/               # Contexto de base de datos
‚îÇ   ‚îî‚îÄ‚îÄ Middleware/         # Middleware personalizado
‚îú‚îÄ‚îÄ PetCareFrond/           # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/     # Componentes React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/       # Servicios de API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/          # Tipos TypeScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx         # Componente principal
‚îÇ   ‚îî‚îÄ‚îÄ public/             # Archivos est√°ticos
‚îú‚îÄ‚îÄ Migrations/             # Migraciones de EF
‚îî‚îÄ‚îÄ docker-compose.yml      # Configuraci√≥n Docker
```

---

## üöÄ Instalaci√≥n

### Prerrequisitos
- Docker Desktop
- Node.js 16+ (para desarrollo frontend)
- .NET 8 SDK (para desarrollo backend)

### Instalaci√≥n Completa con Docker

1. **Clonar el repositorio:**
```bash
git clone https://github.com/WooshC/PetCareServicios.git
cd PetCareServicios
```

2. **Ejecutar con Docker Compose:**
```bash
docker-compose up -d
```

3. **Verificar que todo est√© funcionando:**
```bash
# Verificar contenedores
docker ps

# Verificar API
curl http://localhost:5000/api/auth/health

# Acceder a la aplicaci√≥n
# Frontend: http://localhost:3000
# API: http://localhost:5000
```

### Instalaci√≥n para Desarrollo

1. **Backend con Docker, Frontend manual:**
```bash
# Ejecutar solo backend y base de datos
docker-compose up -d

# Instalar dependencias del frontend
cd PetCareFrond
npm install

# Ejecutar frontend en desarrollo
npm run dev
```

2. **Todo manual (sin Docker):**
```bash
# Configurar base de datos SQL Server
# Modificar connection string en appsettings.json

# Ejecutar backend
dotnet run

# Ejecutar frontend
cd PetCareFrond
npm install
npm run dev
```

---

## üìñ Uso

### Flujo de Usuario Cliente

1. **Acceso a la aplicaci√≥n:**
   - Abrir `http://localhost:3000`
   - Ver p√°gina de login/registro

2. **Registro como Cliente:**
   - Hacer clic en "Reg√≠strate aqu√≠"
   - Seleccionar rol "Cliente"
   - Completar formulario (nombre, email, contrase√±a)
   - Hacer clic en "Registrarse"
   - Ser√° redirigido al dashboard de cliente

3. **Login como Cliente:**
   - Seleccionar rol "Cliente"
   - Ingresar email y contrase√±a
   - Hacer clic en "Ingresar"
   - Acceder al dashboard de cliente

### Flujo de Usuario Cuidador

1. **Registro como Cuidador:**
   - Hacer clic en "Reg√≠strate aqu√≠"
   - Seleccionar rol "Cuidador"
   - Completar formulario de registro
   - Ser√° redirigido al formulario de perfil

2. **Completar Perfil de Cuidador:**
   - Documento de identidad
   - Tel√©fono de emergencia
   - Horario de atenci√≥n (opcional)
   - Tarifa por hora (opcional)
   - Biograf√≠a (opcional)
   - Experiencia (opcional)
   - Hacer clic en "Crear Perfil de Cuidador"

3. **Dashboard de Cuidador:**
   - Ver informaci√≥n completa del perfil
   - Estado de verificaci√≥n del documento
   - Calificaciones y estad√≠sticas
   - Opciones de gesti√≥n

### Funcionalidades del Dashboard

#### Para Clientes:
- Informaci√≥n b√°sica de la cuenta
- Opci√≥n de cerrar sesi√≥n
- (Futuras funcionalidades: buscar cuidadores, hacer reservas)

#### Para Cuidadores:
- **Perfil Completo:**
  - Foto de perfil
  - Nombre y tipo de usuario
  - Calificaci√≥n promedio con estrellas
  - Estado de verificaci√≥n del documento

- **Informaci√≥n de Contacto:**
  - Documento de identidad
  - Tel√©fono de emergencia
  - Email
  - Fecha de registro

- **Servicios y Tarifas:**
  - Lista de servicios ofrecidos
  - Tarifa por hora
  - Horario de atenci√≥n
  - Estado de disponibilidad

- **Informaci√≥n Personal:**
  - Biograf√≠a
  - Experiencia
  - Estad√≠sticas de trabajo

---

## üîå API Endpoints

### Autenticaci√≥n
```
POST /api/auth/login
POST /api/auth/register
GET  /api/auth/health
```

### Cuidadores
```
GET    /api/cuidador                    # Listar todos los cuidadores
GET    /api/cuidador/{id}               # Obtener cuidador por ID
GET    /api/cuidador/mi-perfil          # Obtener mi perfil (autenticado)
POST   /api/cuidador                    # Crear perfil de cuidador
PUT    /api/cuidador/{id}               # Actualizar cuidador (admin)
PUT    /api/cuidador/mi-perfil          # Actualizar mi perfil
DELETE /api/cuidador/{id}               # Eliminar cuidador (admin)
POST   /api/cuidador/{id}/verificar     # Verificar documento (admin)
```

### Autenticaci√≥n Requerida
Todos los endpoints de cuidadores requieren token JWT en el header:
```
Authorization: Bearer <token>
```

---

## üóÑÔ∏è Base de Datos

### Tablas Principales

#### AspNetUsers (Usuarios)
```sql
Id (int, PK)
UserName (nvarchar)
Email (nvarchar)
Name (nvarchar)
CreatedAt (datetime)
```

#### AspNetRoles (Roles)
```sql
Id (int, PK)
Name (nvarchar)
Description (nvarchar)
```

#### Cuidadores
```sql
CuidadorID (int, PK)
UsuarioID (int, FK -> AspNetUsers.Id)
DocumentoIdentidad (nvarchar(20))
TelefonoEmergencia (nvarchar(15))
Biografia (text, nullable)
Experiencia (text, nullable)
HorarioAtencion (nvarchar(100), nullable)
TarifaPorHora (decimal(10,2), nullable)
CalificacionPromedio (decimal(3,2), default 0.0)
DocumentoVerificado (bit, default false)
FechaVerificacion (datetime, nullable)
FechaCreacion (datetime, default GETUTCDATE())
```

### Relaciones
- `Cuidadores.UsuarioID` ‚Üí `AspNetUsers.Id` (1:1)
- Sistema de roles de ASP.NET Identity

### Migraciones
```bash
# Crear nueva migraci√≥n
dotnet ef migrations add NombreMigracion

# Aplicar migraciones
dotnet ef database update

# Revertir migraci√≥n
dotnet ef database update NombreMigracionAnterior
```

---

## üîß Mantenimiento

Para informaci√≥n detallada sobre mantenimiento, debugging y modificaciones del c√≥digo, consulta el **[README de Mantenimiento](README_MANTENIMIENTO.md)**.

### Puntos Clave de Mantenimiento:

1. **Autenticaci√≥n y Autorizaci√≥n**
   - Configuraci√≥n JWT en `appsettings.json`
   - Middleware de autenticaci√≥n
   - Gesti√≥n de roles

2. **Base de Datos**
   - Migraciones de Entity Framework
   - Configuraci√≥n de conexi√≥n
   - Backup y restauraci√≥n

3. **Frontend**
   - Estados y navegaci√≥n en React
   - Servicios de API
   - Validaciones de formularios

4. **Deployment**
   - Configuraci√≥n Docker
   - Variables de entorno
   - Logs y monitoreo

---

## üêõ Troubleshooting

### Problemas Comunes

#### Error de CORS
```bash
# Verificar configuraci√≥n en Program.cs
# Asegurar que CORS est√© configurado correctamente
```

#### Error de Conexi√≥n a Base de Datos
```bash
# Verificar que SQL Server est√© ejecut√°ndose
docker ps | grep sqlserver

# Verificar connection string
# Revisar logs del contenedor
docker-compose logs petcare-db
```

#### Error de Autenticaci√≥n
```bash
# Verificar configuraci√≥n JWT
# Revisar logs del backend
docker-compose logs petcare-api

# Verificar token en localStorage del navegador
```

#### Frontend No Se Conecta
```bash
# Verificar que el backend est√© ejecut√°ndose
curl http://localhost:5000/api/auth/health

# Verificar URL en servicios de API
# Revisar Network tab del navegador
```

### Logs √ötiles
```bash
# Ver logs del backend
docker-compose logs -f petcare-api

# Ver logs de la base de datos
docker-compose logs -f petcare-db

# Ver logs del frontend (si est√° en Docker)
docker-compose logs -f petcare-frontend
```

### Comandos de Recuperaci√≥n
```bash
# Reconstruir contenedores
docker-compose down
docker-compose up --build -d

# Resetear base de datos
docker-compose down -v
docker-compose up -d

# Limpiar cache de npm
cd PetCareFrond
rm -rf node_modules package-lock.json
npm install
```

---

## üìû Soporte

- **Documentaci√≥n**: Este README y [README de Mantenimiento](README_MANTENIMIENTO.md)
- **Issues**: [GitHub Issues](https://github.com/WooshC/PetCareServicios/issues)
- **Email**: soporte@petcare.com

---

<div align="center">
  <p>üêï <strong>¬°PetCare Funcionando!</strong></p>
  <p>‚ú® Sistema Completo de Cuidado de Mascotas</p>
  <p>üîê Autenticaci√≥n JWT + Roles</p>
  <p>üì± Dashboard Interactivo</p>
  <p>üê≥ Docker + .NET + React</p>
</div> 

